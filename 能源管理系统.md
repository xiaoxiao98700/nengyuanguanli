# **📝 智慧能源管理系统 (EMS) 产品需求说明书 (PRD)**

一、产品概述与愿景 

### **1.1 产品愿景、目标与核心用户画像**

* **产品愿景：** 打造工业/建筑领域的“能源大脑”，通过数据资产化和 AI 驱动，实现能源的零浪费、零碳排、零事故，支撑企业高质量发展和“双碳”目标。

* **核心定位：** 一体化多组织管理云平台，支持集团集中权限管理和多工厂/多建筑的分布式部署，统一标准，集约管理。

* **经济目标：**  
  * 综合能耗（标煤）降低率：3% \- 8%。

  * 负荷预测：$\\text{MAPE} \\le 10\\%$。

* **核心用户画像与需求：**  
  * **调度员：** 核心需求是实时掌控能源平衡、快速处理异常、安全远程控制。关注功能模块是实时监控中心和智能优化调度。

  * **能源专家：** 核心需求是挖掘节能潜力、能耗模型构建、撰写诊断报告。关注功能模块是能效分析平台和基础数据配置。

  * **管理层：** 核心需求是掌握能耗成本 、绩效考核排名 、决策资源投入 。关注功能模块是运营管理中心和移动应用。

  * **运维工程师：** 核心需求是提前发现设备故障、工单流程处理、设备健康状态监测。关注功能模块是资产与运维服务和实时监控中心。

1.2 总体功能架构与技术栈（五层模型）

系统采用面向工业互联网的五层架构 ，确保平台具备高扩展性、高性能和工业级安全性。

* **层次：感知与采集层**  
  * **核心组件/技术栈：** 智能仪表（电、水、气、热）、传感器（温、压、流）、数据采集终端 (DTU/Gateway)。

  * **职责与功能深化：** 实现多能源介质的分类分项计量和高精度实时采集。

* **层次：现场控制层**  
  * **核心组件/技术栈：** PLC/DCS 35、SCADA 36、能源优化控制器 (AEC)。

  * **职责与功能深化：** 执行闭环控制逻辑，提供实时数据和远程控制接口。

* **层次：控制与网络层**  
  * **核心组件/技术栈：** 工业以太网、VPN/专网、工业防火墙、微功率无线、电力线载波。

  * **职责与功能深化：** 实现数据传输的安全隔离；承载控制指令的安全下发；针对老旧项目改造，提供灵活通信方案。

* **层次：平台支撑层**  
  * **核心组件/技术栈：** 工业大数据平台（TSDB/Hadoop、AI/算法引擎（Python/TensorFlow、能源模型库、消息队列（Kafka。

  * **职责与功能深化：** 数据资产化核心：数据的存储、清洗、计算、高级分析、模型训练与推理。采用微服务架构（如 Spring Cloud/K8s）确保高可用性。

* **层次：应用与门户层**  
  * **核心组件/技术栈：** Web Portal (B/S 结构)、移动 App、大屏可视化、API Gateway。

  * **职责与功能深化：** 提供用户界面、业务逻辑、决策支持；实现与外部系统（MES/ERP/EAM）的 northbound 接口交互。

二、详细功能模块说明

2.1 模块一：基础数据配置

2.1.1 计量点管理与分类分项管理

* **功能：点位配置**  
  * **业务主逻辑：** 录入点位 ID 和通信参数，绑定所属设备（从资产台账选择，绑定至分类分项树的叶子节点。

  * **交互要求：** 支持 Excel 模板**导入/导出**、自动校验必填项和格式。支持在分项树上**拖拽绑定**点位。

  * **限制条件：** 计量点 ID 在整个组织架构下唯一。通信地址（Modbus 地址/寄存器）必须是正整数，超出范围报错。

* **功能：分类分项树**  
  * **业务主逻辑：** 按照国家标准（用途、介质、区域）建立三级或四级分类树。

  * **交互要求：** 支持管理员动态增删改分类节点，并自动更新所有关联的分析报表。

  * **限制条件：** 建议分类层级不超过四级（区域 $\\rightarrow$ 楼宇/车间 $\\rightarrow$ 分项 $\\rightarrow$ 设备）。

2.1.2 协议与网关

* **功能：协议配置**  
  * **业务主逻辑：** 为不同的网关/DTU 配置其支持的工业协议，并上传解析模板（如 Modbus 寄存器映射表。

  * **交互要求：** 提供常见的 PLC/仪表型号的**预设协议模板**，用户可一键套用。

  * **限制条件：** 协议端口配置需记录在安全审计日志中。必须兼容 Modbus RTU/TCP、OPC UA/DA、IEC 104 等主流工业协议。

* **功能：网关状态监控**  
  * **业务主逻辑：** 实时接收网关心跳包，判断其在线状态、延迟和丢包率。

  * **交互要求：** 在**通信拓扑图**上用颜色（绿/红）实时显示网关状态。  
    **限制条件：** 网关连续 $N=5$ 个心跳失败，自动触发通信故障告警 。

* **其他配置（根据 CSV 文件）：**  
  * **能源类型配置：** 维护能源编码、名称、类型、计量单位、**标煤折算系数**、启用状态、父能源名称等属性。  
  * **能源指标配置：** 实现对能源监测指标的配置。  
  * **能源成本配置：** 实现对各类能源的**价格**（如分时电价）的配置。  
  * **KPI 模型配置：** 实现对工序、设备、仪表、物资及其关系的配置。  
  * **组织结构配置：** 实现组织结构层级的管理配置（全厂、分厂）。

2.2 模块二：实时监控中心

* **功能：基础大屏/全屏轮播**  
  * **业务主逻辑：** 对企业的整体厂区的能耗和能效数据集中展示。将系统展示的各种画面配置在看板上轮流播放展示。

  * **交互要求：** 模块配置支持自定义展示信息，如总能耗、能耗费用占比、告警信息、能耗桑基图等 。

* **功能：用能监测（电/水/蒸汽/压缩空气/氮气/其他能源）**  
  * **业务主逻辑：** 对各类能源的相关参数（电流、电压、流量、电度等）进行实时监测和历史追踪查询。

  * **交互要求：** 以**曲线图、表格方式**展示。

* **功能：能源潮流图（动态可视化）**

  * **业务主逻辑：** 系统从 TSDB 实时获取关键节点数据（流量、压力、温度、功率），并以**动态流速和颜色编码**的形式在 3D/GIS 图上展现。

  * **交互要求：** **颜色预警**：关键参数接近高高限时，管线颜色由绿 $\\rightarrow$ 黄 $\\rightarrow$ 红，并闪烁。数据刷新频率 $\\le 3$ 秒。

  * **限制条件：** 潮流图数据必须经过 DQC 清洗。仅显示已配置为关键节点的测点数据。

* **功能：SCADA 监测（能源拓扑图/一次系统图）**  
  * **业务主逻辑：** 通过组态画面可视化展示各种能源系统流向图，如电力、水、蒸汽、压缩空气等能源流向系统图。展示电力一次负荷分布图，显示总表和分表的实时负荷和占比。

* **功能：数据穿透**  
  * **业务主逻辑：** 用户点击潮流图上的任一设备图标，弹出其实时参数卡片和历史曲线。

  * **交互要求：** 卡片内容包含设备名称、实时功率/流量、今日累计能耗、最近一次告警时间。

  * **限制条件：** 仅限具备该区域数据权限的用户可查看。

* **功能：实时告警中心**

  * **业务主逻辑：** 告警引擎实时监测数据流。触发机制包括：越限（$P \> P\_{\\text{high}}$ 或 $P \< P\_{\\text{low}}$）、变化率超限、平值（连续 N 个周期值不变）、关联告警。

  * **功能：告警追溯与闭环**  
    * **业务主逻辑：** 告警触发时，系统自动冻结并存储告警发生前后的高频数据快照（秒级数据）。

    * **操作流程：** 调度员点击“确认” $\\rightarrow$ 填写确认备注 $\\rightarrow$ 一键派单 $\\rightarrow$ 根因分析报告（填写原因、解决方案） $\\rightarrow$ 最终“归档”。

    * **限制条件：** 只有填写了原因分析和解决方案后，告警状态才能变更为“已归档”。系统自动统计 MTTR。

* **功能：远程控制**

  * **业务主逻辑：** 用户发起控制指令 $\\rightarrow$ 系统执行权限校验 $\\rightarrow$ 生成电子操作票 $\\rightarrow$ 指令通过安全通道下发至现场 PLC/DCS。

  * **交互要求：** 核心控制操作必须要求**双重身份验证**（密码 \+ 验证码/指纹）。操作票必须详细记录操作人、时间、指令内容、审批人。

  * **限制条件：** 指令下发前，系统必须校验预设的**软件联锁逻辑**（如“在泵 A 开启时，禁止开启阀 B”）。联锁失败则拒绝执行。仅限高级调度员角色具备远程控制权限。

2.3 模块三：能效分析

* **功能：分类/分项统计分析**  
  * **业务主逻辑：** 实现对各种能源监测点的量、费用、标煤量进行数据查询。支持用电尖峰平谷的分时段查询。

  * **交互要求：** 通过图表（饼图、柱状图、曲线图）展示。支持同环比、对比、时比等分析。

* **功能：多维分析**

  * **业务主逻辑：** 支持按时间、介质、区域、工序、用途、产品等**六大维度**进行交叉分析和**下钻 (Drill-down)** 查询。

  * **交互要求：** 提供类似 Excel **数据透视表**的维度拖拽功能。

  * **限制条件：** 工序/产品维度分析必须依赖 **MES 产量数据**的集成。数据统计支持分钟、小时、日、月、年粒度切换。

* **功能：能源平衡分析**

  * **业务主逻辑：** 对指定区域或系统，进行输入-输出-损耗的平衡分析，计算产销差。

  * **可视化：** 使用\*\*桑基图（Sankey Diagram）\*\*直观展示能源流向和损耗比例。

  * **判断条件：** 产销差（$\\text{输入} \- \\text{输出} \- \\text{损耗}$）超过 $\\pm 5\\%$ 时，触发平衡异常告警。

* **功能：能耗对标/核算**

  * **业务主逻辑：** 1\. 从 MES 获取生产批次信息和产量。2. 查询关联设备的能源消耗。3. 应用折标煤系数进行综合能耗计算。$E\_{\\text{product}} \= \\frac{\\sum (E\_{i} \\times \\alpha\_{i})}{\\text{产出量}}$。

  * **数据展示：** 实时展示**单位产品能耗排名**（按班组、工序、时间）。

  * **能耗定额管理：** 允许用户为不同的产品/工序设定能耗定额 143。实时核算的单位产品能耗 $\\ge$ 定额值时，触发预警。

* **功能：能源损失与浪费诊断**

  * **泄漏损失诊断：** 利用管网平衡分析，识别水/气管网“跑、冒、滴、漏”，并转化为损失金额。判断条件：夜间流量 $\>$ 基础流量且持续 $T$ 小时。

  * **无效加工诊断：** 识别空载运行、非最优工况运行、过度供能导致的能源浪费。报告输出“浪费量”和“浪费金额”。

2.4 模块四：智能优化调度

* **功能：负荷预测**

  * **业务主逻辑：** 基于历史负荷、气象数据、生产计划等多维输入，通过 LSTM/GRU 深度学习模型预测未来 24h / 15min 负荷。

  * **可视化：** 预测曲线必须与实际负荷曲线**同屏展示**，并展示置信区间（如 95%）。实时展示 MAPE 值。

  * **限制条件：** $\\text{MAPE}$ 必须 $\\le 10\\%$。若连续 3 天 $\\text{MAPE} \> 10\\%$，触发模型精度预警。

* **功能：需量管理辅助**  
  * **业务主逻辑：** 实时预测当日最大需量，若预测值 $\\ge$ 合同需量上限，触发**削峰预警**。

  * **建议：** 系统自动推荐\*\*“削峰策略”\*\*（建议关闭的非核心设备清单及对应削减负荷量）。

  * **安全限制：** 推荐的削峰设备必须在**可中断负荷清单内**。

* **功能：经济运行调度**

  * **优化模型运行：** 目标函数是**综合能源总成本最小化** $\\min(\\sum C\_{\\text{total}})$。基于线性/非线性规划 (LP/NLP) 求解最优解。

  * **结果展示：** 展示\*\*“优化前成本” vs “优化后成本”\*\*。输出设备最优运行负荷分配表。

  * **运行模式：** 必须支持**辅助决策**（仅建议）和**自动闭环控制**两种模式。自动闭环控制前必须经过安全联锁逻辑校验。

2.5 模块五：运营管理与治理

* **功能：绩效考核**

  * **考核模型配置：** 允许管理层自定义考核对象（部门/车间/班组）、考核周期、考核指标（单位产品能耗、能耗降低率、MTTR）及其**权重**。

  * **可视化：** 提供考核结果的**仪表盘和排名榜**。

  * **数据来源：** 考核数据必须来源于经过 DQC 清洗和单位产品核算后的结果。仅限管理层/系统管理员可修改考核权重。

* **功能：报表自动化**

  * **报表生成：** 用户选择报表模板（国家标准能源审计报表、自定义报表），系统自动填充数据并生成报告。包括运行报表、统计日/月/年报表、工艺能耗表、能源平衡报表。

  * **定时任务：** 支持配置定时自动生成并邮件发送给指定接收人。支持一键导出 PDF、Excel。

  * **合规性：** 报表数据必须可追溯至原始采集值和修正日志。

2.6 模块六：资产与运维服务

* **功能：设备健康度与预测性维护**

  * **健康指数评价：** 基于能效偏差率、振动、温度等多维数据，运行 AI 模型计算健康指数（0-100 分）。

  * **可视化：** 设备卡片上展示健康指数评分卡和性能排名。绘制健康指数的**衰减趋势预测线**。

  * **预警条件：** 健康指数 $\< 60$ 分时，触发预测性维护预警。预警自动触发 EAM/CMMS 系统的维护工单。

* **功能：电能质量治理**  
  * **业务主逻辑：** 监测谐波含量、三相不平衡度等电能质量参数，并提供治理方案建议。

  * **专业图表：** 必须展示**谐波频谱图**。

  * **标准限制：** 监测结果必须符合国家/行业电能质量标准（如电压偏差 $\\le \\pm 7\\%$）。

* **功能：移动应用**

  * **核心功能：** 告警实时推送与处理、核心 KPI 驾驶舱（总能耗、能耗排名）、历史数据查询、异常工单审批。

  * **交互逻辑：** 使用原生推送服务。核心 KPI 和最新告警列表支持离线缓存和查看。

  * **限制条件：** 远程控制等高风险操作**禁止在 App 上直接执行**，仅支持查看状态和审批。移动端数据权限与 Web 端严格一致。

三、关键业务流程深化与非功能性要求

3.1 业务主流程：能源优化与闭环

流程旨在融合分析、决策和控制，实现持续的节能降耗。

1. **数据采集与清洗**

   * **逻辑判断：** DQC 引擎判断数据是否异常（跳变、缺失）。

   * **清洗逻辑：** 异常数据应用插值算法修正。

   * **限制：** 采集率必须 $\\ge 98.0\\%$。

2. **智能预测** 209

   * **逻辑判断：** 负荷预测模型判断未来负荷是否接近需量上限或峰谷时段。

   * **交互：** 预测结果曲线实时在调度中心展示。

3. **优化求解与决策**

   * **优化逻辑：** LP/NLP 模型以**总成本最小化**为目标求解最优工况。

   * **判断：** 优化结果是否满足所有工艺约束（压力、温度等）。

   * **限制：** 优化结果必须在设备运行安全范围内。

4. **调度员确认** 216

   * **操作逻辑：** 调度员查看优化建议，对比优化收益和潜在风险。

   * **交互：** 调度员点击\*\*“执行”或“拒绝”\*\*，并填写理由。

5. **指令下发与联锁**

   * **安全联锁：** 系统进行最终安全联锁校验（软件和硬件联锁）。

   * **操作逻辑：** 指令通过安全通道下发至现场 PLC/DCS 221。

   * **限制：** 联锁失败，指令必须被阻止，并触发安全告警。

6. **能效分析与考核**

   * **逻辑判断：** 实时能耗偏差率是否超限（实际 VS 基线）。

   * **闭环：** 偏差率超限时，流程回溯至告警追溯环节进行根因分析。

3.2 非功能性要求与技术规范

* **高性能/可扩展性**  
  * **详细规范：** 数据吞吐量支持 **10 万+ 测点并发写入**，秒级存储。复杂查询响应时间 $\\le 10$ 秒 。

  * **技术实现：** 采用时序数据库（TSDB）（如 InfluxDB/TDengine）。微服务架构支持水平扩展 。

  * **指标：** 核心 API 响应延迟 $\\le 300$ 毫秒 。

* **安全要求（工业级）**  
  * **详细规范：** 遵循工业控制系统安全标准，数据采集网络与办公网络**逻辑隔离** 。所有 Web/App 交互使用 HTTPS/SSL 加密 234。

  * **技术实现：** 工业防火墙、入侵检测系统 (IDS) 。OAuth 2.0/JWT 认证机制 ；关键操作**双重认证** 237。

  * **限制：** 所有安全事件必须记录在审计日志中，且不可篡改 。

* **可靠性/可用性**  
  * **指标：** 系统年可用性 (SLA) $\\ge 99.7\\%$ 。故障平均恢复时间 (MTTR) 降低 50% 。

  * **技术实现：** 应用服务、数据库均采用集群部署 ；数据库支持主从热备 。采集网关具备本地存储和断点续传能力 。

3.3 UI/UX 详细交互要求 

* **KPI 仪表盘**  
  * **交互细节：** 核心 KPI 使用卡片展示，卡片颜色随趋势变化（**红升绿降**）。

  * **逻辑判断：** 实时 KPI 超过历史均值/基线时，卡片背景颜色加深 。

  * **操作限制：** 仪表盘布局支持**个性化定制**（不同角色展示不同内容）。

* **曲线图组件**  
  * **交互细节：** 曲线支持缩放、平移 248；支持在图上拖拽选择区域进行数据放大或导出 。鼠标悬停时，显示精确到**毫秒级的时间戳和数值** 。

  * **操作限制：** 曲线数量超过 5 条时，自动提示用户进行曲线筛选 。

* **数据筛选器**  
  * **交互细节：** 筛选器支持多选（介质、区域、分项），且选择结果实时影响图表 。

  * **逻辑判断：** 筛选条件改变时，系统在 **3 秒内**完成数据重绘 。

  * **操作限制：** 时间筛选器支持自定义时间段和预设时间段（如今日、本周、上月）。  
